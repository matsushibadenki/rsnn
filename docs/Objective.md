# **RSNN（スパイキングニューラルネットワーク）目標達成ロードマップ**

提示された5つの目標（①高精度, ②低消費電力, ③再現性, ④非GPU, ⑤非BP）を達成するため、現状のNumpyベース（src/rsnn/core/models.py）のSNNアーキテクチャを発展させるロードマップを以下に定義する。

## **フェーズ1: 基盤安定化とベンチマーク（1〜3ヶ月）**

**目標:** CIFAR-10を扱える基盤を構築し、目標③（学習再現性）のベースラインを確立する。

### **1.1. データセットの拡張 (CIFAR-10対応)**

* **タスク:** 現在のトイ・データセット (src/rsnn/experiments/dataset.py) に加え、CIFAR-10（またはステップとしてMNIST/Fashion-MNIST）をロードし、スパイク信号に変換する機能を追加する。  
* **担当:** src/rsnn/core/encoding.py, src/rsnn/experiments/dataset.py  
* **ゴール:** CIFAR-10画像をPoisson符号化またはLatency符号化（latency\_burst\_encoding）でネットワークに入力できるようにする。

### **1.2. ネットワークアーキテクチャの多層化**

* **タスク:** src/rsnn/core/base\_rsnn.py を拡張し、単層隠れ層だけでなく、多層（例：Input \-\> L1(SNN) \-\> L2(SNN) \-\> Readout）のSNNを構築できるようにする。  
* **担当:** src/rsnn/core/models.py, src/rsnn/di/containers.py  
* **ゴール:** 畳み込みSNN（CSNN）の足掛かりとして、層間の接続と学習ルール（STDP）を定義できるようにする。

### **1.3. 再現性テストパイプラインの構築 (目標③)**

* **タスク:** tools/health\_check.py や src/rsnn/services/experiment\_service.py を拡張し、複数シード（例：30回）での学習を自動実行し、精度の平均と標準偏差、および「目標精度（例：80%）に達した割合」をレポートする機能を追加する。  
* **担当:** tools/, src/rsnn/experiments/reporting.py  
* **ゴール:** 学習再現性の定量的ベンチマークを確立する。

### **1.4. 代替学習ルールの調査・実装 (目標⑤)**

* **タスク:** 現状のSTDP (src/rsnn/core/learning\_rules.py) に加え、誤差逆伝播（BP）を使わない他の学習ルール（R-STDP: 報酬駆動型STDP、Tempotronなど）を調査し、1つをプロトタイプ実装する。  
* **担当:** src/rsnn/core/learning\_rules.py  
* **ゴール:** BPに代わる学習方法の候補を絞り込む。

## **フェーズ2: 精度向上（目標①）と効率化（目標④, ②）**

**目標:** ネットワーク構造と学習則を根本的に強化し、目標①（高精度）の達成を目指す。同時に、目標④・②（非GPU・低消費電力）の基盤を構築する。

### **2.1. 疎なイベント駆動型シミュレータの実装 (目標④, ②)**

* **タスク:** 現状のNumpyベースのシミュレーション（毎ステップ全ニューロンの電圧を計算）から、スパイク（イベント）が発生したニューロンとそれに接続するシナプスのみを計算する「イベント駆動型」シミュレータへ移行する。  
* **担当:** src/rsnn/core/ (新規モジュール)  
* **ゴール:** 行列計算への依存を排除し（目標④）、計算量を大幅に削減する（目標②の基盤）。

### **2.2. 畳み込みSNN（CSNN）アーキテクチャの導入**

* **タスク:** フェーズ1.2の多層化を発展させ、畳み込み層（重み共有）とプーリング層（スパイクベース）の概念をNumpyベース（またはイベント駆動型）で実装する。  
* **担当:** src/rsnn/core/models.py  
* **ゴール:** CIFAR-10のような画像タスクにおいて、特徴抽出の効率と精度を向上させる。

### **2.3. BP代替学習アルゴリズムの本格導入 (目標⑤)**

* **タスク:** BPの代替として有望な学習アルゴリズム（例：Surrogate Gradient法, Equilibrium Propagation, ターゲット射影）を本格的に実装・比較検討する。  
* **備考:** Surrogate Gradient法はBPに似るが、SNNの文脈では標準的な手法の一つ。目標⑤の「模索」の一環として許容するかを定義する必要がある。  
* **担当:** src/rsnn/core/learning\_rules.py  
* **ゴール:** CIFAR-10において、STDPを超える精度を達成する非BP学習法を選定する。

### **2.4. 消費電力（スパイク数）の精密計測 (目標②)**

* **タスク:** src/rsnn/experiments/evaluation.py に、単なる精度（acc）だけでなく、推論1回あたりの総スパイク数、平均スパイクレートを計測する機能を追加する。  
* **担当:** src/rsnn/experiments/evaluation.py, src/rsnn/services/experiment\_service.py  
* **ゴール:** モデルの「消費電力（＝スパイク数）」を定量化し、最適化の指標とする。

## **フェーズ3: 統合と目標実証（3〜6ヶ月）**

**目標:** 全ての目標（①〜⑤）を同時に達成するモデルと構成を実証する。

### **3.1. ハイパーパラメータ自動最適化**

* **タスク:** フェーズ2で構築したCSNNおよび学習則（2.2, 2.3）の多数のパラメータ（config/experiment\_params.json）を効率的に最適化するため、scikit-learnのGridSearchCVやOptunaなどのベイズ最適化ツールと連携する。  
* **担当:** src/main.py, scripts/ (新規)  
* **ゴール:** 精度、消費電力、再現性のバランスが取れた最適パラメータを発見する。

### **3.2. 精度ベンチマーク（CIFAR-10） (目標①)**

* **タスク:** 最適化されたモデル（3.1）を使用し、CIFAR-10での認識精度 95〜97% の達成を実証する。  
* **ゴール:** 目標①の達成。

### **3.3. 消費電力（演算）シミュレーション (目標②)**

* **タスク:** イベント駆動シミュレータ（2.1）で計測した演算量（SNN）と、同等の精度を持つANN（例：小規模CNN）のFLOPs（浮動小数点演算回数）を比較・試算する。  
* **ゴール:** SNNの演算量がANN比で1/50以下（またはそれ以下）となることを実証する（目標②）。

### **3.4. 最終再現性検証 (目標③)**

* **タスク:** 最終モデル（3.1）に対し、フェーズ1.3のパイプラインを用いて大規模な再現性テスト（例：100シード）を実行する。  
* **ゴール:** 学習成功率（例：精度95%以上を達成する確率）が95%以上であることを実証する（目標③）。
